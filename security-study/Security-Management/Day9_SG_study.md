# 情報セキュリティマネジメント試験 30日間学習計画Day 9

## 📚 今日の学習テーマ：暗号技術（公開鍵と認証）

### 📝 学習の目標

* 公開鍵暗号方式の基本原理と共通鍵暗号方式との違いを理解する

* RSA暗号やECCなど公開鍵アルゴリズムの仕組みと特徴を把握する

* 電子署名、ハッシュ関数、PKIの概念と実際の応用例を学ぶ

### 🔍 カバーする範囲

本日は公開鍵暗号方式とその応用技術について学習します。RSA暗号やECCなどの公開鍵アルゴリズム、秘密鍵・公開鍵ペアの使用法、ハッシュ関数の役割、電子署名の仕組み、そしてPKI（公開鍵基盤）の概念と実装について理解を深めます。

## 📖 解説パート

### 公開鍵暗号方式の基本

公開鍵暗号方式は、暗号化と復号に異なる鍵を使用する非対称暗号の一種です。共通鍵暗号方式（対称暗号）では同じ鍵を暗号化と復号の両方に使用するため、安全な鍵配送が課題でしたが、公開鍵暗号方式ではこの問題を解決しています。

公開鍵暗号方式では、ユーザーは「公開鍵」と「秘密鍵」のペアを持ちます。公開鍵は誰にでも公開可能で、この鍵で暗号化されたデータは、対応する秘密鍵でのみ復号できます。秘密鍵は本人だけが保持し、決して他者に渡してはいけません。

この仕組みにより、機密情報を送りたい場合は、受信者の公開鍵で暗号化すれば、その受信者のみが自分の秘密鍵で復号できるため、安全な通信が可能になります。また、秘密鍵でデータに署名することで、その署名が対応する公開鍵で検証できれば、確かに秘密鍵の所有者が作成したものと証明できます（電子署名の原理）。

### RSAとECCの仕組み

#### RSA暗号

RSA暗号は1977年に開発された最も広く使われている公開鍵暗号アルゴリズムです。その安全性は大きな数の素因数分解の困難さに基づいています。

RSAの鍵生成プロセスは以下の通りです：
1. 二つの大きな素数p, qを選ぶ
2. n = p × qを計算する
3. φ(n) = (p-1)(q-1)を計算する
4. eを選ぶ（1 < e < φ(n)かつgcd(e, φ(n)) = 1）
5. d × e ≡ 1 (mod φ(n))となるようなdを計算する
6. 公開鍵は(n, e)、秘密鍵は(n, d)となる

暗号化：C = M^e mod n（Mは平文、Cは暗号文）
復号：M = C^d mod n

RSAは処理速度が比較的遅いため、大量データの暗号化には向いていません。そのため、実際の通信では共通鍵暗号と組み合わせたハイブリッド方式が採用されることが多いです。

#### 楕円曲線暗号（ECC）

ECCはRSAより短い鍵長で同等のセキュリティを提供できる公開鍵暗号方式です。その安全性は楕円曲線上の離散対数問題の困難さに基づいています。

ECCの主な利点：
- 短い鍵長（256ビットのECCは3072ビットのRSAと同等のセキュリティ）
- 計算効率の良さ
- 省メモリ・省電力であるため、IoTデバイスなどのリソース制約のある環境に適している

### 電子署名とPKI

#### 電子署名

電子署名は、デジタル文書の作成者を証明し、文書が改ざんされていないことを保証するための技術です。電子署名の基本的な仕組みは以下の通りです：

1. 署名者は文書のハッシュ値を計算する
2. そのハッシュ値を署名者の秘密鍵で暗号化する（これが署名となる）
3. 検証者は署名者の公開鍵を使って署名を復号し、ハッシュ値を取得する
4. 検証者は文書から独自にハッシュ値を計算し、署名から得たハッシュ値と比較する
5. 両者が一致すれば、文書は改ざんされておらず、確かに署名者によって署名されたと確認できる

電子署名は、電子商取引、電子政府サービス、ソフトウェア配布など多くの分野で利用されています。日本では「電子署名法」によって、一定の要件を満たす電子署名は手書き署名や押印と同等の法的効力を持つと認められています。

#### ハッシュ関数

ハッシュ関数は、任意長のデータを固定長の値（ハッシュ値）に変換する関数です。暗号学的ハッシュ関数には以下の特性が求められます：

- 一方向性：ハッシュ値から元のデータを復元することが計算上不可能
- 衝突耐性：異なる入力から同じハッシュ値を生成することが困難
- 雪崩効果：入力の小さな変化でもハッシュ値が大きく変わる

代表的なハッシュアルゴリズムには、MD5（現在は脆弱性があり非推奨）、SHA-1（同じく非推奨）、SHA-256、SHA-3などがあります。

#### PKI（公開鍵基盤）

PKIは、公開鍵暗号を実用的に運用するためのフレームワークです。PKIの主な構成要素は以下の通りです：

- 認証局（CA）：公開鍵証明書を発行・管理する信頼できる第三者機関
- 登録局（RA）：証明書申請者の身元確認を行い、CAに証明書発行を依頼する
- 証明書リポジトリ：発行された証明書を保管・公開するデータベース
- 証明書失効リスト（CRL）：無効化された証明書のリスト

PKIにより、インターネット上で見知らぬ相手の公開鍵が確かにその人物のものであることを検証できます。これはWebサイトの認証（HTTPS）、セキュアメール、電子署名など多くの用途で不可欠です。

#### 重要ポイント

* 公開鍵暗号方式は暗号化と復号に異なる鍵を使用し、鍵配送問題を解決する

* RSAは素因数分解の困難さ、ECCは楕円曲線上の離散対数問題の困難さに安全性の基盤を置いている

* 電子署名は「否認防止」と「完全性の確保」という重要なセキュリティ機能を提供する

* PKIは公開鍵の信頼性を担保するための仕組みであり、認証局による証明書発行が核心となる

## 🏢 ケーススタディ

### ケース：偽造された SSL/TLS 証明書によるなりすまし攻撃

2011年、オランダの認証局DigiNotarがハッキングされ、Googleを含む複数のドメインに対する偽のSSL証明書が不正に発行されました。この事件では、イランのユーザーを標的に、中間者攻撃によってGmailの通信が傍受されたと考えられています。ユーザーのブラウザは正規のGoogleサイトと通信していると信じていましたが、実際には攻撃者のサーバーと通信していました。最終的にDigiNotarは信頼を失い、破産に追い込まれました。

#### 問題点

* 認証局のセキュリティ侵害により、信頼されるべき証明書発行プロセスが破綻した

* ブラウザやOSは認証局を信頼するモデルに依存しており、一つの認証局の侵害が広範な影響を及ぼす

* 証明書の不正発行を迅速に検知する仕組みが不十分だった

#### 対応策

* 証明書透明性（Certificate Transparency）の導入：すべての発行された証明書を公開ログに記録し、不正発行を検知しやすくする

* HSTS（HTTP Strict Transport Security）の実装：常にHTTPSでの接続を強制し、SSL Strippingなどの攻撃を防ぐ

* 証明書ピンニング：アプリケーションが特定の証明書や公開鍵のみを受け入れるよう設定する

* 複数の認証局による証明書のクロスチェック：一つの認証局の侵害による影響を軽減する

* 証明書失効メカニズム（CRL、OCSP）の強化：不正な証明書を迅速に無効化する

#### ケースから学ぶ教訓

* PKIの信頼性は最も弱いリンク（認証局）のセキュリティに依存している

* 技術的な対策だけでなく、認証局の運用・監査体制も重要である

* セキュリティインシデント発生時の迅速な対応と透明性が信頼回復には不可欠

## 📝 理解度チェックテスト

以下の問題を解いて、今日の学習内容の理解度をチェックしましょう。

### 問題1

公開鍵暗号方式に関する説明として、最も適切なものはどれか。

1. 暗号化と復号に同じ鍵を使用する

2. 暗号化には公開鍵、復号には秘密鍵を使用する

3. 鍵長が短いため処理速度が速い

4. 主に大量データの暗号化に使用される

### 問題2

RSA暗号の安全性の基盤となる数学的問題はどれか。

1. 楕円曲線上の離散対数問題

2. 素因数分解問題

3. ナップサック問題

4. 巡回グラフ問題

### 問題3

電子署名の主な目的として、適切でないものはどれか。

1. データの機密性を確保する

2. 送信者の認証を行う

3. データの完全性を検証する

4. 送信者による否認を防止する

### 問題4

PKI（公開鍵基盤）の構成要素として、含まれないものはどれか。

1. 認証局（CA）

2. 暗号化エンジン（CE）

3. 登録局（RA）

4. 証明書失効リスト（CRL）

### 問題5

以下のハッシュ関数のうち、現在のセキュリティ標準で安全とされているのはどれか。

1. MD5

2. SHA-1

3. SHA-256

4. RIPEMD-128

## 📋 今日のまとめ

* 公開鍵暗号方式は秘密鍵と公開鍵のペアを使用し、鍵配送問題を解決するとともに、電子署名による認証や否認防止の機能を提供する

* RSAは素因数分解の困難さに基づく暗号方式で広く普及しているが、ECCはより短い鍵長で同等のセキュリティを提供できる次世代の公開鍵暗号方式として注目されている

* PKIは認証局を中心とした信頼の連鎖により、インターネット上での公開鍵の信頼性を担保する重要な基盤である

### 次回予告

明日は「認証技術（パスワード・多要素）」について学習します。パスワード管理の基本から多要素認証、シングルサインオンなど、ユーザー認証に関する技術と実装方法を詳しく見ていきます。

## ✅ テスト回答・解説

### 問題1 正解：2

公開鍵暗号方式では、暗号化には受信者の公開鍵を使用し、復号には受信者の秘密鍵を使用します。1は共通鍵暗号方式の説明です。3と4は誤りで、公開鍵暗号は鍵長が長く処理速度が遅いため、通常は大量データの暗号化には向いておらず、共通鍵暗号と組み合わせて使用されます。

### 問題2 正解：2

RSA暗号の安全性は大きな合成数の素因数分解の困難さに基づいています。1はECCの安全性の基盤、3と4はRSAとは関係のない問題です。

### 問題3 正解：1

電子署名の主な目的は、送信者の認証（2）、データの完全性の検証（3）、送信者による否認の防止（4）です。データの機密性の確保（1）は電子署名の目的ではなく、暗号化によって達成されます。電子署名自体はデータを秘匿化しません。

### 問題4 正解：2

PKIの主な構成要素には、認証局（CA）、登録局（RA）、証明書リポジトリ、証明書失効リスト（CRL）などがありますが、「暗号化エンジン（CE）」という構成要素は存在しません。

### 問題5 正解：3

SHA-256は現在のセキュリティ標準で安全とされているハッシュ関数です。MD5とSHA-1は衝突攻撃に対して脆弱性が発見されており、セキュリティ用途では非推奨とされています。RIPEMD-128も128ビットハッシュ長は現在のセキュリティ要件を満たしていません。

## 📚 参考資料・リソース

* 『暗号技術入門 第3版』結城浩著、SBクリエイティブ

* CRYPTREC暗号リスト（電子政府推奨暗号リスト）：https://www.cryptrec.go.jp/list.html

* NIST Special Publication 800-57 Part 1 Rev. 5: Recommendation for Key Management

* RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile
