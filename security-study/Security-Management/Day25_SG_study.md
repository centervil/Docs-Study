# 情報セキュリティマネジメント試験 30日間学習計画Day 25

## 📚 今日の学習テーマ：セキュアプロトコル – IPsec/TLS/SSH/WPA

### 📝 学習の目標

* ネットワークプロトコルの安全化の重要性を理解する。
* IPsec、TLS、SSH、WPAといった主要なセキュアプロトコルの概要と役割を説明できるようになる。
* 無線LANにおけるWPA2およびWPA3のセキュリティ機能の違いを理解する。
* セキュアプロトコルを導入する際の一般的な課題を認識する。

### 🔍 カバーする範囲

本日は、インターネット通信や無線LAN接続を安全に行うための主要なセキュアプロトコルに焦点を当てます。IPsec、TLS、SSHといった有線・無線ネットワークで利用されるプロトコルに加え、無線LAN固有のセキュリティ規格であるWPA2およびWPA3について学習します。これらのプロトコルがどのようにデータの機密性、完全性、可用性を保護しているのか、また導入時に考慮すべき課題についても触れます。

## 📖 解説パート

### セキュアプロトコルの概要 (IPsec, TLS, SSH)

ネットワーク通信の安全性を確保するために、様々なセキュアプロトコルが開発され利用されています。

**IPsec (Internet Protocol Security)** は、IP層（ネットワーク層）で動作するプロトコルスイートです。主にVPN (Virtual Private Network) などで利用され、IPパケット単位での認証や暗号化を提供します。AH (Authentication Header) と ESP (Encapsulating Security Payload) という二つの主要なプロトコルから構成され、データの完全性、認証、機密性を保護します。IPsecはOSやルーターなどのネットワーク機器に実装されることが多く、透過的なセキュリティを提供できる点が特徴です。

**TLS (Transport Layer Security)** は、SSL (Secure Sockets Layer) の後継として開発されたプロトコルで、トランスポート層で動作します。主にWebブラウザとWebサーバー間の通信（HTTPS）で利用されますが、メール（SMTPS, IMAPS, POP3S）やその他のアプリケーション層プロトコルでも広く利用されています。TLSは、サーバー認証、クライアント認証（オプション）、通信データの暗号化、メッセージの完全性検証を提供します。公開鍵暗号と共通鍵暗号を組み合わせたハイブリッド暗号方式を採用しており、安全かつ効率的な通信を実現します。

**SSH (Secure Shell)** は、ネットワーク経由で別のコンピューターに安全に接続するためのプロトコルです。主にリモートログインやファイル転送（SFTP, SCP）に利用されます。SSHはクライアントとサーバー間で安全なチャネルを確立し、通信内容の盗聴や改ざんを防ぎます。公開鍵認証やパスワード認証などの認証方式をサポートしており、安全なリモート管理に不可欠なプロトコルです。

これらのプロトコルは、それぞれ異なるOSI参照モデルの層で動作し、異なる用途で利用されますが、いずれも通信の安全性を確保するという共通の目的を持っています。

### 無線LANセキュリティ (WPA2/WPA3) と導入課題

無線LAN (Wi-Fi) は利便性が高い反面、電波が物理的な境界を越えるため、適切なセキュリティ対策が不可欠です。無線LANのセキュリティ規格は、WEP、WPA、WPA2、WPA3と進化してきました。

**WPA2 (Wi-Fi Protected Access II)** は、現在広く普及している無線LANセキュリティ規格です。強力な暗号化アルゴリズムであるAES (Advanced Encryption Standard) と、認証メカニズムとしてIEEE 802.1XまたはPSK (Pre-Shared Key) を使用します。PSK方式は家庭や小規模オフィスでよく利用され、アクセスポイントとクライアントデバイスが共通のパスフレーズを用いて認証を行います。WPA2はWEPやWPAの脆弱性を克服し、一定レベルのセキュリティを提供しますが、PSKの脆弱性（辞書攻撃など）や、KRACK (Key Reinstallation Attacks) と呼ばれる脆弱性が発見されたこともあります。

**WPA3 (Wi-Fi Protected Access III)** は、WPA2の後継として登場した最新の無線LANセキュリティ規格です。WPA3では、PSKに代わるSAE (Simultaneous Authentication of Equals) という新しい鍵交換方式が導入され、オフライン辞書攻撃に対する耐性が向上しました。また、公共のオープンWi-Fiネットワーク向けに、個別のデータ暗号化を提供するWi-Fi Enhanced Openという機能が追加されました。これにより、パスワード保護されていないネットワークでも一定のプライバシーが確保されます。WPA3は、より強力なセキュリティを提供し、将来の無線LANセキュリティの標準となることが期待されています。

セキュアプロトコルを導入する際には、いくつかの課題が存在します。例えば、**証明書管理** はTLSやIPsecにおいて重要ですが、証明書の取得、配布、更新、失効といった運用は煩雑になりがちです。また、**鍵交換** の仕組みを正しく理解し、安全な鍵長やアルゴリズムを選択する必要があります。さらに、プロトコルの**安全な設定** が不可欠です。デフォルト設定のまま使用したり、不適切な設定を行ったりすると、プロトコル本来のセキュリティ効果が得られない可能性があります。これらの課題を克服するためには、技術的な知識に加え、適切な運用管理体制が求められます。

#### 重要ポイント

* IPsecはネットワーク層で動作し、VPNなどで利用される。
* TLSはトランスポート層で動作し、HTTPSなどで通信の暗号化と認証を行う。
* SSHは安全なリモート接続やファイル転送に利用される。
* WPA2はAES暗号化とPSKまたは802.1X認証を使用する。
* WPA3はSAE鍵交換方式を導入し、セキュリティが強化されている。
* セキュアプロトコル導入には、証明書管理、鍵交換、安全な設定といった課題がある。

## 🏢 ケーススタディ

### ケース：公共Wi-Fiでの情報漏洩リスク

出張中の社員が、カフェの無料公共Wi-Fiに接続し、会社のWebメールにログインしました。この際、WebメールへのアクセスにHTTPSではなくHTTPが使用されていました。同じWi-Fiネットワークに接続していた攻撃者は、通信内容を傍受し、社員のログイン情報（ユーザー名とパスワード）を不正に入手しました。

#### 問題点

* 公共Wi-Fiのような信頼できないネットワークでセキュリティ対策が不十分な通信（HTTP）を利用したこと。
* WebメールへのアクセスにHTTPSが強制されていなかったこと。
* 攻撃者が通信を傍受できる環境であったこと。

#### 対応策

* 公共Wi-Fiを利用する際は、VPN接続を必須とする。
* Webメールシステムにおいて、常時HTTPS接続を強制する設定を行う。
* 従業員に対し、公共Wi-Fi利用時のリスクと安全な利用方法（VPN利用、HTTPS確認など）についてセキュリティ教育を実施する。
* 多要素認証を導入し、パスワードが漏洩しても不正ログインを防ぐ対策を講じる。

#### ケースから学ぶ教訓

* 信頼できないネットワークでの通信には、必ずVPNやHTTPSなどのセキュアプロトコルを利用する必要がある。
* システム側でセキュアな通信を強制する設定は、ユーザーのセキュリティリスクを低減するために重要である。
* 従業員への継続的なセキュリティ教育は、人的要因によるインシデントを防ぐ上で不可欠である。

## 📝 理解度チェックテスト

以下の問題を解いて、今日の学習内容の理解度をチェックしましょう。

### 問題1

IPsecが主に動作するOSI参照モデルの層として正しいものはどれですか？

1. アプリケーション層
2. トランスポート層
3. ネットワーク層
4. データリンク層

### 問題2

WebブラウザとWebサーバー間の安全な通信（HTTPS）に主に利用されるセキュアプロトコルはどれですか？

1. SSH
2. IPsec
3. TLS
4. WPA3

### 問題3

無線LANセキュリティ規格WPA3で、WPA2のPSKに代わって導入され、オフライン辞書攻撃への耐性を向上させた新しい鍵交換方式は何ですか？

1. AES
2. SAE
3. TKIP
4. CCMP

### 問題4

リモートサーバーへの安全な接続やファイル転送に利用されるセキュアプロトコルはどれですか？

1. HTTP
2. FTP
3. Telnet
4. SSH

### 問題5

セキュアプロトコル導入時の課題として考えにくいものはどれですか？

1. 証明書の管理
2. 鍵交換方式の選択
3. プロトコルの安全な設定
4. 通信速度の極端な向上

## 📋 今日のまとめ

* ネットワーク通信の安全化にはIPsec, TLS, SSHなどのセキュアプロトコルが不可欠です。
* 無線LANセキュリティはWPA2からWPA3へと進化し、より強力な認証・暗号化が提供されています。
* セキュアプロトコルを効果的に利用するためには、適切な設定と運用管理が重要です。

### 次回予告

明日は「ネットワークセキュリティ – FW/VPN/Honeypot など」について学習します。

## ✅ テスト回答・解説

### 問題1 正解：3

[解説：IPsecはIPパケット単位でセキュリティを提供するため、OSI参照モデルのネットワーク層（第3層）で動作します。]

### 問題2 正解：3

[解説：TLS（Transport Layer Security）は、Web通信（HTTP）を暗号化し、サーバー認証などを行うために広く利用されています。HTTPSはHTTP over TLS/SSLの略です。]

### 問題3 正解：2

[解説：WPA3では、WPA2のPSKに代わり、SAE（Simultaneous Authentication of Equals）という新しい鍵交換方式が採用されました。これにより、パスワード推測によるオフライン辞書攻撃に対する耐性が向上しています。]

### 問題4 正解：4

[解説：SSH（Secure Shell）は、ネットワーク経由で別のコンピューターに安全に接続するためのプロトコルです。リモートログインやファイル転送（SFTP, SCP）に利用され、通信内容を暗号化します。]

### 問題5 正解：4

[解説：セキュアプロトコルの導入は、暗号化や認証処理のためにオーバーヘッドが発生し、通信速度がわずかに低下する可能性があります。したがって、通信速度の極端な向上はセキュアプロトコル導入時の課題としては考えにくいです。証明書管理、鍵交換、安全な設定は、セキュアプロトコルを適切に運用する上で重要な課題です。]

## 📚 参考資料・リソース

* 情報処理推進機構（IPA）: 情報セキュリティ白書
* 独立行政法人情報処理推進機構（IPA）: セキュア・プログラミング講座
* 各プロトコルのRFCドキュメント