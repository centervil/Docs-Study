# 情報セキュリティマネジメント試験 30日間学習計画Day 10

## 📚 今日の学習テーマ：認証技術（パスワード・多要素）

### 📝 学習の目標

* パスワード管理の基本原則と安全な実装方法を理解する

* ワンタイムパスワードや多要素認証の仕組みと利点を把握する

* シングルサインオンやパスワードレス認証など、最新の認証技術の動向を学ぶ

### 🔍 カバーする範囲

本日はユーザ認証技術について学習します。パスワード管理の基本から、ワンタイムパスワード、多要素認証、シングルサインオン、パスワードレス認証まで、様々な認証方式の仕組みと特徴、実装方法について理解を深めます。

## 📖 解説パート

### パスワード認証の基本と安全な管理

パスワード認証は最も一般的な認証方式ですが、適切に管理されなければ重大なセキュリティリスクとなります。パスワードの安全な管理には以下の原則が重要です。

**パスワードの生成と強度**：強力なパスワードは、十分な長さ（最低12文字以上）を持ち、大文字・小文字・数字・特殊文字を組み合わせたものが理想的です。ただし、複雑すぎるパスワードはユーザーが覚えられず、書き留めるなどの危険な行動につながる可能性があります。最近では、複数の単語を組み合わせた「パスフレーズ」の使用が推奨されています。

**パスワードの保存**：システム側でパスワードを保存する際は、平文ではなく必ずハッシュ化して保存します。さらに、「ソルト」と呼ばれるランダムな値を各ユーザーのパスワードに追加してからハッシュ化することで、同じパスワードでも異なるハッシュ値になり、レインボーテーブル攻撃などを防ぐことができます。また、bcryptやArgon2などの計算コストの高いハッシュ関数を使用することで、総当たり攻撃に対する耐性を高めることができます。

**パスワード変更ポリシー**：従来は定期的なパスワード変更が推奨されていましたが、現在のNISTガイドラインでは、強制的な定期変更はユーザーに単純な変更パターンを促すため推奨されていません。代わりに、侵害が疑われる場合や、ユーザーが希望する場合にのみ変更を促すアプローチが推奨されています。

**パスワード再利用の防止**：ユーザーが同じパスワードを複数のサービスで使い回すことは大きなリスクです。一つのサービスが侵害されると、他のサービスも危険にさらされます。組織内では、過去に使用したパスワードの再利用を禁止する仕組みを導入することが重要です。

### ワンタイムパスワードと時間ベース認証

ワンタイムパスワード（OTP）は、一度だけ使用可能なパスワードで、盗聴や盗み見による被害を軽減できます。主に以下の種類があります。

**HMAC-based OTP (HOTP)**：共有秘密鍵とカウンター値に基づいて生成されるOTPです。ユーザーがボタンを押すたびに新しいパスワードが生成されます。

**Time-based OTP (TOTP)**：共有秘密鍵と現在時刻に基づいて生成されるOTPです。通常30秒ごとに新しいパスワードが生成されます。Google AuthenticatorやMicrosoft Authenticatorなどのアプリで広く使用されています。

**SMS OTP**：ワンタイムパスワードをSMSで送信する方式です。スマートフォンを持っていれば追加のデバイスが不要という利点がありますが、SIMスワッピング攻撃などのリスクがあるため、セキュリティ要件の高いシステムでは避けられる傾向にあります。

ワンタイムパスワードは、通常の固定パスワードと組み合わせて使用され、二要素認証の一部として実装されることが多いです。

### 多要素認証の仕組みと実装

多要素認証（MFA）は、複数の異なる種類の認証要素を組み合わせることで、セキュリティを強化する手法です。認証要素は主に以下の3種類に分類されます。

**知識要素（Something you know）**：パスワード、PINコード、秘密の質問など、ユーザーが知っている情報。

**所有要素（Something you have）**：スマートフォン、セキュリティトークン、スマートカードなど、ユーザーが物理的に所持しているもの。

**生体要素（Something you are）**：指紋、顔、虹彩、声紋など、ユーザーの身体的特徴。

多要素認証では、これらの異なるカテゴリから少なくとも2つの要素を組み合わせます。例えば、パスワード（知識要素）とスマートフォンアプリのTOTP（所有要素）の組み合わせが一般的です。

多要素認証の実装には、以下のような方法があります：

**アプリベースの認証器**：Google AuthenticatorやMicrosoft Authenticatorなどのアプリを使用したTOTP認証。

**プッシュ通知**：認証リクエストをモバイルデバイスにプッシュ通知として送信し、ユーザーが承認するか拒否するかを選択する方式。

**ハードウェアトークン**：YubiKeyなどの物理的なセキュリティキーを使用する方式。USBポートに接続するか、NFC通信で認証を行います。

**生体認証**：指紋認証や顔認証などを使用する方式。通常はデバイス上で認証が完結し、生体情報自体はサーバーに送信されません。

### シングルサインオンとフェデレーション

シングルサインオン（SSO）は、一度の認証で複数のシステムやアプリケーションにアクセスできる仕組みです。ユーザーの利便性を高めるとともに、パスワードの使い回しを減らし、セキュリティを向上させる効果があります。

**SSOの主な実装方式**：

1. **SAML（Security Assertion Markup Language）**：XMLベースのオープン標準で、IDプロバイダとサービスプロバイダ間で認証情報を交換するために使用されます。エンタープライズ環境で広く採用されています。

2. **OAuth 2.0**：主に認可（Authorization）のためのフレームワークですが、OpenID Connectと組み合わせることで認証にも使用されます。

3. **OpenID Connect**：OAuth 2.0の上に構築された認証レイヤーで、JSONウェブトークン（JWT）を使用してユーザー情報を安全に伝達します。

**フェデレーション認証**は、異なる組織間でユーザー認証情報を共有する仕組みです。例えば、大学のアカウントで学術ジャーナルにアクセスしたり、企業のアカウントでクラウドサービスを利用したりすることができます。

### パスワードレス認証とFIDO

パスワードレス認証は、従来のパスワードを使用せずにユーザーを認証する方法です。パスワード管理の負担を軽減し、フィッシング攻撃などのリスクを低減できます。

**FIDO（Fast IDentity Online）**は、パスワードレス認証の標準規格を開発するアライアンスです。FIDOの主な規格には以下があります：

1. **FIDO U2F（Universal 2nd Factor）**：パスワードと組み合わせて使用する二要素認証の規格。

2. **FIDO2**：WebAuthnとCTAP（Client to Authenticator Protocol）から構成され、完全なパスワードレス認証を実現します。ユーザーは指紋認証や顔認証などの生体認証、またはPINコードとセキュリティキーの組み合わせで認証を行います。

**WebAuthn（Web Authentication）**は、W3CとFIDOアライアンスが共同で開発したウェブ標準で、ウェブアプリケーションでの強力な認証を可能にします。主要なウェブブラウザはすべてWebAuthnをサポートしており、指紋認証や顔認証などのプラットフォーム組み込みの認証器や、YubiKeyなどの外部セキュリティキーを使用できます。

#### 重要ポイント

* パスワードはハッシュ化してソルトを加えて保存し、強力なハッシュアルゴリズムを使用する

* 多要素認証は異なるカテゴリ（知識・所有・生体）から少なくとも2つの要素を組み合わせることで、単一要素の脆弱性を補完する

* シングルサインオンは利便性とセキュリティのバランスを取りつつ、認証の一元管理を実現する

* パスワードレス認証はFIDO2やWebAuthnなどの標準に基づき、フィッシング耐性のある強力な認証を提供する

## 🏢 ケーススタディ

### ケース：大手クラウドサービスにおける認証情報漏洩事件

2019年、あるクラウドストレージサービスで数百万ユーザーの認証情報が漏洩する事件が発生しました。調査の結果、パスワードはハッシュ化されていたものの、古いアルゴリズム（MD5）が使用され、ソルトが適用されていなかったことが判明しました。攻撃者はレインボーテーブルを使用して多くのパスワードを復元し、同じパスワードを使い回しているユーザーの他のサービスアカウントにもアクセスしました。さらに、この企業は多要素認証をオプション機能としてのみ提供しており、ほとんどのユーザーが有効化していなかったため、被害が拡大しました。

#### 問題点

* 安全性の低いハッシュアルゴリズム（MD5）を使用し、ソルトを適用していなかった

* 多要素認証がデフォルトで有効化されておらず、ユーザーの採用率が低かった

* パスワードの使い回しによる二次被害が発生した

#### 対応策

* 強力なハッシュアルゴリズム（bcrypt、Argon2など）とソルトの使用を徹底する

* 多要素認証をデフォルトで有効化するか、強く推奨する仕組みを導入する

* パスワードの強度チェックを実装し、弱いパスワードや漏洩したパスワードの使用を防止する

* 定期的なセキュリティ監査を実施し、認証システムの脆弱性を早期に発見する

* ユーザーに対してパスワードマネージャーの使用を推奨し、パスワードの使い回しを防止する

#### ケースから学ぶ教訓

* 認証システムは常に最新のセキュリティベストプラクティスに従って設計・実装する必要がある

* セキュリティと利便性のバランスを考慮しつつも、重要なセキュリティ機能（多要素認証など）はデフォルトで有効化することが望ましい

* ユーザー教育も重要な対策の一つであり、安全なパスワード管理の重要性を継続的に啓発すべきである

## 📝 理解度チェックテスト

以下の問題を解いて、今日の学習内容の理解度をチェックしましょう。

### 問題1

パスワードの安全な保存方法として、最も適切なものはどれか。

1. 可逆的な暗号化アルゴリズムで暗号化して保存する

2. MD5でハッシュ化して保存する

3. ソルトを加えてbcryptでハッシュ化して保存する

4. Base64エンコードして保存する

### 問題2

多要素認証に関する説明として、正しくないものはどれか。

1. 知識要素、所有要素、生体要素の3つのカテゴリがある

2. パスワードと秘密の質問の組み合わせは、強力な多要素認証である

3. スマートフォンアプリのTOTPは所有要素に分類される

4. 指紋認証は生体要素に分類される

### 問題3

ワンタイムパスワード（OTP）に関する説明として、最も適切なものはどれか。

1. 一度使用したパスワードは二度と使用できない

2. TOTPは時間に基づいて生成され、通常30秒ごとに変更される

3. SMSで送信されるOTPは最も安全な認証方式である

4. OTPは単独で使用すれば、多要素認証となる

### 問題4

シングルサインオン（SSO）の利点として、適切でないものはどれか。

1. ユーザーの利便性が向上する

2. パスワードの使い回しを減らせる

3. 認証の一元管理が可能になる

4. 認証情報が漏洩した場合の影響範囲が限定される

### 問題5

FIDO2に関する説明として、正しいものはどれか。

1. パスワードと組み合わせてのみ使用できる認証規格である

2. WebAuthnとCTAPから構成され、パスワードレス認証を実現する

3. 生体認証情報は常に認証サーバーに送信される

4. 主に企業内システムでのみ利用可能な規格である

## 📋 今日のまとめ

* パスワード認証は最も一般的な認証方式だが、適切なハッシュ化とソルトの使用、強力なパスワードポリシーが不可欠である

* 多要素認証は知識要素、所有要素、生体要素の異なるカテゴリから複数の要素を組み合わせることで、セキュリティを大幅に強化できる

* シングルサインオンは利便性を高めつつセキュリティも向上させるが、認証基盤の保護が極めて重要になる

* パスワードレス認証はFIDO2やWebAuthnなどの標準に基づき、フィッシング攻撃に強い次世代の認証方式として普及が進んでいる

### 次回予告

明日は「生体認証・トークン」について学習します。指紋認証、顔認証、虹彩認証などの生体認証技術の仕組みと特徴、セキュリティトークンの種類と用途について詳しく見ていきます。

## ✅ テスト回答・解説

### 問題1 正解：3

パスワードの安全な保存方法は、ソルトを加えてbcryptなどの強力なハッシュアルゴリズムでハッシュ化することです。可逆的な暗号化（1）では、暗号化キーが漏洩した場合にパスワードが復元されるリスクがあります。MD5（2）は衝突耐性が低く、現在は安全でないとされています。Base64エンコード（4）は暗号化ではなく、簡単にデコードできるため、パスワード保存には適していません。

### 問題2 正解：2

パスワードと秘密の質問はどちらも「知識要素」に分類されるため、真の多要素認証とはなりません。多要素認証は異なるカテゴリ（知識・所有・生体）から要素を組み合わせる必要があります。他の選択肢はすべて正しい説明です。

### 問題3 正解：2

TOTPは時間に基づいて生成され、通常30秒ごとに新しいパスワードが生成されます。選択肢1は部分的に正しいですが、TOTPの場合は時間経過で同じコードが再利用される可能性があります。SMSで送信されるOTP（3）はSIMスワッピング攻撃などのリスクがあり、最も安全とは言えません。OTP単独（4）は一要素認証であり、多要素認証にはなりません。

### 問題4 正解：4

SSOの場合、認証情報が漏洩すると、連携しているすべてのサービスにアクセスされる可能性があるため、影響範囲は広くなります。これはSSOの欠点の一つです。他の選択肢はすべてSSOの正しい利点です。

### 問題5 正解：2

FIDO2はWebAuthnとCTAPから構成され、パスワードレス認証を実現する規格です。FIDO2は単独で使用可能（1は誤り）で、生体認証情報はデバイス内で処理され、サーバーには送信されません（3は誤り）。また、一般のウェブサイトでも利用可能です（4は誤り）。

## 📚 参考資料・リソース

* NIST Special Publication 800-63B: Digital Identity Guidelines (Authentication and Lifecycle Management)

* OWASP Authentication Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html

* FIDO Alliance: https://fidoalliance.org/

* 『サイバーセキュリティ プロフェッショナル』 著：高橋正和、他、日経BP
