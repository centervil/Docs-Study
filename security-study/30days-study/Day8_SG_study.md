# 情報セキュリティマネジメント試験 30日間学習計画Day 8

## 📚 今日の学習テーマ：暗号技術（対称鍵暗号）

### 📝 学習の目標

* 共通鍵暗号方式（対称鍵暗号）の基本概念と仕組みを理解する

* 代表的な暗号アルゴリズム（AES、Triple DESなど）の特徴を把握する

* ハッシュ関数とメッセージダイジェストの役割と用途を理解する

* 暗号鍵の管理方法と安全な運用について学ぶ

### 🔍 カバーする範囲

今日は情報セキュリティの基盤技術である暗号技術、特に共通鍵暗号方式について学習します。暗号化・復号の基本的な仕組み、代表的なアルゴリズム、ハッシュ関数の役割、そして暗号鍵の管理方法までを体系的に理解していきます。

## 📖 解説パート

### 共通鍵暗号方式の基本

共通鍵暗号方式（対称鍵暗号）は、暗号化と復号に同じ鍵を使用する暗号方式です。送信者と受信者が同一の秘密鍵を共有し、その鍵を使ってデータの暗号化と復号を行います。この方式の最大の特徴は処理速度が速いことで、大量のデータを効率的に暗号化できます。

共通鍵暗号は主に2種類に分類されます。1つはブロック暗号で、データを一定サイズのブロックに分割して処理します。もう1つはストリーム暗号で、データを連続的なビット列（ストリーム）として処理します。ブロック暗号の代表例がAES（Advanced Encryption Standard）やDES（Data Encryption Standard）、ストリーム暗号の例としてはRC4などがあります。

共通鍵暗号方式の最大の課題は、安全に鍵を共有する方法です。暗号化通信を行う前に、何らかの方法で秘密鍵を安全に相手に渡す必要があります。この問題を解決するために、後に学ぶ公開鍵暗号方式と組み合わせたハイブリッド暗号システムが実用的に使われています。

### 代表的な暗号アルゴリズム

#### AES（Advanced Encryption Standard）

現在、最も広く使われている共通鍵暗号アルゴリズムです。2001年に米国標準技術研究所（NIST）によって標準化されました。128ビット、192ビット、256ビットの鍵長をサポートし、128ビットのブロックサイズで処理を行います。AESは高い安全性と処理効率を両立しており、多くのセキュリティプロトコルやアプリケーションで採用されています。

#### Triple DES（3DES）

DES（Data Encryption Standard）を3回適用することで安全性を高めた暗号アルゴリズムです。DESは1977年に標準化されましたが、56ビットの鍵長は現代のコンピュータでは解読可能なため、Triple DESが開発されました。ただし、AESと比較すると処理速度が遅いため、レガシーシステムでの使用が中心となっています。

#### その他の共通鍵暗号アルゴリズム

Blowfish、Twofish、IDEA、CAMELLIAなど様々なアルゴリズムが存在します。特にCAMELLIAは日本で開発された128ビットブロック暗号で、AESと同等の安全性を持ちます。

#### 重要ポイント

* 共通鍵暗号は処理速度が速いが、鍵配布の問題がある

* AESは現在の標準的な共通鍵暗号アルゴリズムであり、十分な安全性を持つ

* 鍵長が長いほど理論上は安全性が高まるが、処理負荷も増加する

### ハッシュ関数とメッセージダイジェスト

ハッシュ関数は、任意長のデータを固定長の値（ハッシュ値またはメッセージダイジェスト）に変換する一方向関数です。暗号技術において重要な役割を果たし、データの完全性検証やパスワード保存などに利用されます。

良いハッシュ関数は以下の特性を持ちます：
1. 一方向性：ハッシュ値から元のデータを復元することが計算量的に不可能
2. 衝突耐性：異なる入力から同じハッシュ値が生成される確率が極めて低い
3. 雪崩効果：入力の小さな変化でもハッシュ値が大きく変わる

代表的なハッシュアルゴリズムには以下があります：

- MD5：128ビットのハッシュ値を生成。現在は脆弱性が発見されており、セキュリティ用途には推奨されない
- SHA-1：160ビットのハッシュ値を生成。衝突攻撃が実証されており、新規システムでの使用は避けるべき
- SHA-256/SHA-384/SHA-512：SHA-2ファミリーに属し、それぞれ256/384/512ビットのハッシュ値を生成。現在広く使用されている
- SHA-3：最新のハッシュ標準で、SHA-2とは異なる設計原理に基づいている

ハッシュ関数は暗号化ではなく、データの指紋（フィンガープリント）を作成するものです。元のデータを復元する手段はないため、データの完全性検証や改ざん検知に適しています。

### 暗号鍵の管理

暗号技術の安全性は、アルゴリズムの強度だけでなく、鍵の管理方法にも大きく依存します。適切な鍵管理には以下の要素が含まれます：

1. **鍵の生成**：暗号学的に安全な乱数生成器（CSPRNG）を使用して、予測不可能な鍵を生成する

2. **鍵の保管**：鍵は暗号化されたデータとは別の安全な場所に保管し、アクセス制御を厳格に行う

3. **鍵の配布**：共通鍵を安全に配布するために、公開鍵暗号方式やセキュアチャネルを利用する

4. **鍵の更新**：定期的に鍵を更新し、同じ鍵を長期間使用しない

5. **鍵の廃棄**：不要になった鍵は適切に廃棄し、復元できないようにする

企業環境では、HSM（Hardware Security Module）と呼ばれる専用ハードウェアを使用して鍵を保管・管理することが一般的です。HSMは物理的に保護された環境で暗号鍵を管理し、不正アクセスから守ります。

ストレージ暗号化においては、ディスク全体を暗号化するFDE（Full Disk Encryption）や、特定のファイルやフォルダを暗号化するファイルレベル暗号化が利用されます。これらの技術は、デバイスの紛失や盗難時のデータ保護に有効です。

## 🏢 ケーススタディ

### ケース：医療機関の患者データ暗号化不備による情報漏洩

ある地方の総合病院で、患者の診療記録や個人情報を含むバックアップデータが外部に漏洩する事件が発生しました。調査の結果、バックアップデータは暗号化されていたものの、暗号鍵がバックアップと同じサーバー上に平文で保存されていたことが判明しました。攻撃者はサーバーへの不正アクセスにより、暗号鍵とバックアップデータの両方を入手し、患者情報を復号することに成功していました。

#### 問題点

* 暗号鍵が暗号化対象と同じ場所に保存されていた

* 鍵へのアクセス制御が不十分だった

* 暗号化だけに依存し、多層防御の考え方が欠如していた

#### 対応策

* 暗号鍵は暗号化データとは物理的に分離された安全な場所（HSMなど）に保管する

* 鍵へのアクセスには多要素認証を導入し、アクセスログを取得・監視する

* バックアップデータへのアクセス制御を強化し、不正アクセス検知システムを導入する

* 定期的に暗号鍵をローテーションし、同じ鍵を長期間使用しない

* 重要データには強力な暗号アルゴリズム（AES-256など）を使用する

#### ケースから学ぶ教訓

* 暗号化はセキュリティ対策の一部であり、それだけでは完全な保護にならない

* 鍵管理は暗号システム全体の安全性を左右する重要な要素である

* 技術的対策と運用管理の両面からセキュリティを考える必要がある

## 📝 理解度チェックテスト

以下の問題を解いて、今日の学習内容の理解度をチェックしましょう。

### 問題1

共通鍵暗号方式の特徴として、最も適切なものはどれか。

1. 暗号化と復号に異なる鍵を使用する

2. 暗号化と復号に同じ鍵を使用する

3. 暗号化には公開鍵、復号には秘密鍵を使用する

4. 鍵を使わずに暗号化を行う

### 問題2

現在、最も広く使われている共通鍵暗号アルゴリズムはどれか。

1. DES

2. Triple DES

3. AES

4. RSA

### 問題3

ハッシュ関数の特性として、誤っているものはどれか。

1. 入力データの小さな変化でもハッシュ値が大きく変わる

2. ハッシュ値から元のデータを復元できる

3. 任意長のデータを固定長の値に変換する

4. データの完全性検証に利用できる

### 問題4

共通鍵暗号方式の課題として、最も適切なものはどれか。

1. 処理速度が遅い

2. 安全に鍵を共有する方法が難しい

3. 大量のデータを暗号化できない

4. 暗号化の強度が低い

### 問題5

以下のうち、現在セキュリティ用途に推奨されないハッシュアルゴリズムはどれか。

1. SHA-256

2. SHA-3

3. MD5

4. HMAC

## 📋 今日のまとめ

* 共通鍵暗号方式は暗号化と復号に同じ鍵を使用し、処理速度が速いが鍵配布の課題がある

* AESは現在の標準的な共通鍵暗号アルゴリズムで、128/192/256ビットの鍵長をサポートしている

* ハッシュ関数は一方向性を持ち、データの完全性検証やパスワード保存に利用される

* 暗号鍵の適切な管理（生成・保管・配布・更新・廃棄）は暗号システムの安全性を確保する上で極めて重要である

### 次回予告

明日は「暗号技術（公開鍵と認証）」について学習します。RSA暗号やECCなどの公開鍵アルゴリズム、電子署名、PKI（公開鍵基盤）について理解を深めていきましょう。

## ✅ テスト回答・解説

### 問題1 正解：2

共通鍵暗号方式（対称鍵暗号）は、暗号化と復号に同じ鍵を使用します。これに対し、公開鍵暗号方式（非対称鍵暗号）は異なる鍵ペア（公開鍵と秘密鍵）を使用します。選択肢1と3は公開鍵暗号方式の特徴を述べており、選択肢4は暗号化の基本原則に反します。

### 問題2 正解：3

AES（Advanced Encryption Standard）は現在最も広く使われている共通鍵暗号アルゴリズムです。DESは古く安全性に問題があり、Triple DESはAESより処理効率が劣ります。RSAは公開鍵暗号アルゴリズムであり、共通鍵暗号ではありません。

### 問題3 正解：2

ハッシュ関数の重要な特性の一つは一方向性であり、ハッシュ値から元のデータを復元することは計算量的に不可能です。これはハッシュ関数と暗号化の根本的な違いです。他の選択肢はすべてハッシュ関数の正しい特性を述べています。

### 問題4 正解：2

共通鍵暗号方式の最大の課題は、安全に鍵を共有する方法です。暗号化通信を行う前に、何らかの方法で秘密鍵を安全に相手に渡す必要があります。この問題を解決するために、公開鍵暗号方式と組み合わせたハイブリッド暗号システムが実用的に使われています。

### 問題5 正解：3

MD5は128ビットのハッシュ値を生成するアルゴリズムですが、衝突攻撃に対して脆弱であることが証明されており、現在はセキュリティ用途には推奨されていません。SHA-256とSHA-3は現在安全とされているハッシュアルゴリズムです。HMACはハッシュベースのメッセージ認証コードで、ハッシュアルゴリズムと秘密鍵を組み合わせて使用します。

## 📚 参考資料・リソース

* 『暗号技術入門 第3版 秘密の国のアリス』結城浩著、SBクリエイティブ

* NIST Special Publication 800-57 "Recommendation for Key Management"

* 情報処理推進機構（IPA）「暗号鍵管理ガイドライン」

* RFC 8017 - PKCS #1: RSA Cryptography Specifications Version 2.2
